# Effort

Контролируйте, сколько токенов использует Claude при ответе с помощью параметра effort, балансируя между полнотой ответа и эффективностью использования токенов.

---

Параметр effort позволяет вам контролировать, насколько охотно Claude тратит токены при ответе на запросы. Это дает вам возможность балансировать между полнотой ответа и эффективностью использования токенов, используя одну модель.

<Note>
  Параметр effort в настоящее время находится в бета-версии и поддерживается только Claude Opus 4.5.

  Вы должны включить [бета-заголовок](/docs/ru/api/beta-headers) `effort-2025-11-24` при использовании этой функции.
</Note>

## Как работает effort

По умолчанию Claude использует максимальный effort — тратит столько токенов, сколько необходимо для достижения наилучшего результата. Снижая уровень effort, вы можете указать Claude быть более консервативным в использовании токенов, оптимизируя скорость и стоимость, при этом принимая некоторое снижение возможностей.

<Tip>
Установка `effort` на `"high"` дает ровно такое же поведение, как если бы параметр `effort` вообще не был указан.
</Tip>

Параметр effort влияет на **все токены** в ответе, включая:

- Текстовые ответы и объяснения
- Вызовы инструментов и аргументы функций
- Расширенное мышление (если включено)

Этот подход имеет два основных преимущества:

1. Он не требует включения мышления для его использования.
2. Он может влиять на все расходы токенов, включая вызовы инструментов. Например, более низкий effort означает, что Claude делает меньше вызовов инструментов. Это дает гораздо больший контроль над эффективностью.

### Уровни effort

| Уровень  | Описание                                                                                                                      | Типичный случай использования                                                                      |
| -------- | -------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------- |
| `high`   | Максимальные возможности. Claude использует столько токенов, сколько необходимо для достижения наилучшего результата. Эквивалентно отсутствию параметра.  | Сложные рассуждения, сложные задачи кодирования, агентские задачи                           |
| `medium` | Сбалансированный подход с умеренной экономией токенов. | Агентские задачи, требующие баланса скорости, стоимости и производительности                                                         |
| `low`    | Наиболее эффективный. Значительная экономия токенов с некоторым снижением возможностей. | Более простые задачи, требующие лучшей скорости и наименьших затрат, такие как подагенты                     |

## Базовое использование

<CodeGroup>
```python Python
import anthropic

client = anthropic.Anthropic()

response = client.beta.messages.create(
    model="claude-opus-4-5-20251101",
    betas=["effort-2025-11-24"],
    max_tokens=4096,
    messages=[{
        "role": "user",
        "content": "Analyze the trade-offs between microservices and monolithic architectures"
    }],
    output_config={
        "effort": "medium"
    }
)

print(response.content[0].text)
```

```typescript TypeScript
import Anthropic from '@anthropic-ai/sdk';

const client = new Anthropic();

const response = await client.beta.messages.create({
  model: "claude-opus-4-5-20251101",
  betas: ["effort-2025-11-24"],
  max_tokens: 4096,
  messages: [{
    role: "user",
    content: "Analyze the trade-offs between microservices and monolithic architectures"
  }],
  output_config: {
    effort: "medium"
  }
});

console.log(response.content[0].text);
```

```bash Shell
curl https://api.anthropic.com/v1/messages \
    --header "x-api-key: $ANTHROPIC_API_KEY" \
    --header "anthropic-version: 2023-06-01" \
    --header "anthropic-beta: effort-2025-11-24" \
    --header "content-type: application/json" \
    --data '{
        "model": "claude-opus-4-5-20251101",
        "max_tokens": 4096,
        "messages": [{
            "role": "user",
            "content": "Analyze the trade-offs between microservices and monolithic architectures"
        }],
        "output_config": {
            "effort": "medium"
        }
    }'
```

</CodeGroup>

## Когда следует регулировать параметр effort?

- Используйте **high effort** (по умолчанию), когда вам нужна лучшая работа Claude — сложные рассуждения, тонкий анализ, сложные задачи кодирования или любая задача, где качество является главным приоритетом.
- Используйте **medium effort** как сбалансированный вариант, когда вы хотите хорошую производительность без полного расхода токенов high effort.
- Используйте **low effort**, когда вы оптимизируете скорость (потому что Claude отвечает с меньшим количеством токенов) или стоимость — например, простые задачи классификации, быстрые поиски или высокообъемные случаи использования, где незначительные улучшения качества не оправдывают дополнительную задержку или расходы.

## Effort с использованием инструментов

При использовании инструментов параметр effort влияет как на объяснения вокруг вызовов инструментов, так и на сами вызовы инструментов. Более низкие уровни effort, как правило:

- Объединяют несколько операций в меньшее количество вызовов инструментов
- Делают меньше вызовов инструментов
- Переходят непосредственно к действию без предисловия
- Используют лаконичные сообщения подтверждения после завершения

Более высокие уровни effort могут:

- Делать больше вызовов инструментов
- Объяснять план перед принятием мер
- Предоставлять подробные резюме изменений
- Включать более полные комментарии кода

## Effort с расширенным мышлением

Параметр effort работает вместе с бюджетом токенов мышления, когда включено расширенное мышление. Эти два элемента управления служат разным целям:

- **Параметр effort**: Контролирует, как Claude тратит все токены — включая токены мышления, текстовые ответы и вызовы инструментов
- **Бюджет токенов мышления**: Устанавливает максимальный лимит на токены мышления конкретно

Параметр effort можно использовать с включенным или отключенным расширенным мышлением. Когда оба настроены:

1. Сначала определите уровень effort, подходящий для вашей задачи
2. Затем установите бюджет токенов мышления на основе сложности задачи

Для лучшей производительности при сложных задачах рассуждения используйте high effort (по умолчанию) с высоким бюджетом токенов мышления. Это позволяет Claude тщательно обдумать и предоставить полные ответы.

## Лучшие практики

1. **Начните с high**: Используйте более низкие уровни effort для обмена производительностью на эффективность использования токенов.
2. **Используйте low для задач, чувствительных к скорости или простых задач**: Когда задержка имеет значение или задачи простые, low effort может значительно сократить время ответа и затраты.
3. **Протестируйте ваш случай использования**: Влияние уровней effort варьируется в зависимости от типа задачи. Оцените производительность на ваших конкретных случаях использования перед развертыванием.
4. **Рассмотрите динамический effort**: Регулируйте effort в зависимости от сложности задачи. Простые запросы могут требовать low effort, в то время как агентское кодирование и сложные рассуждения выигрывают от high effort.