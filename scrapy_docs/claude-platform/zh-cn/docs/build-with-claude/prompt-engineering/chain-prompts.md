# 链接复杂提示以获得更强的性能

学习如何通过提示链接将复杂任务分解为更小的、可管理的子任务，以提高 Claude 的准确性和可追溯性。

---

<Note>
While these tips apply broadly to all Claude models, you can find prompting tips specific to extended thinking models [here](/docs/en/build-with-claude/prompt-engineering/extended-thinking-tips).
</Note>

在处理复杂任务时，如果您尝试在单个提示中处理所有内容，Claude 有时可能会出现问题。思维链 (CoT) 提示很好，但如果您的任务有多个不同的步骤，每个步骤都需要深入思考，该怎么办？

进入提示链接：将复杂任务分解为更小、可管理的子任务。

## 为什么要链接提示？

1. **准确性**：每个子任务都能获得 Claude 的全部注意力，减少错误。
2. **清晰度**：更简单的子任务意味着更清晰的说明和输出。
3. **可追溯性**：轻松识别和修复提示链中的问题。

***

## 何时链接提示

对于多步骤任务（如研究综合、文档分析或迭代内容创建）使用提示链接。当任务涉及多个转换、引用或说明时，链接可以防止 Claude 遗漏或误处理步骤。

**记住**：链中的每个环节都能获得 Claude 的全部注意力！

<Tip>**调试提示**：如果 Claude 遗漏了一个步骤或表现不佳，请在其自己的提示中隔离该步骤。这样您可以微调有问题的步骤，而无需重做整个任务。</Tip>

***

## 如何链接提示

1. **识别子任务**：将您的任务分解为不同的、顺序的步骤。
2. **使用 XML 结构以实现清晰的交接**：使用 XML 标签在提示之间传递输出。
3. **有一个单一任务目标**：每个子任务应该有一个单一、清晰的目标。
4. **迭代**：根据 Claude 的性能改进子任务。

### 示例链接工作流：
- **多步骤分析**：请参阅下面的法律和商业示例。
- **内容创建管道**：研究 → 大纲 → 草稿 → 编辑 → 格式化。
- **数据处理**：提取 → 转换 → 分析 → 可视化。
- **决策制定**：收集信息 → 列出选项 → 分析每个 → 推荐。
- **验证循环**：生成内容 → 审查 → 改进 → 重新审查。

<Tip>**优化提示**：对于具有独立子任务的任务（如分析多个文档），创建单独的提示并并行运行它们以提高速度。</Tip>

### 高级：自我纠正链

您可以链接提示让 Claude 审查自己的工作！这可以捕捉错误并改进输出，特别是对于高风险任务。

  <section title="示例：自我纠正的研究摘要">

    #### 提示 1
    | 角色 | 内容 |
    | ---- | ------- |
    | 用户 | 总结这篇医学研究论文。<br/><br/>\\{\{RESEARCH_PAPER}}\</paper><br/><br/>重点关注方法、发现和临床意义。 |
    | 助手<br/>\{\{SUMMARY}} | 方法：双盲随机对照试验 (RCT)，包含 500 名 2 型糖尿病患者。A 组 (n=250) 接受新型 GLP-1/GIP 双激动剂；B 组 (n=250) 接受标准 GLP-1 激动剂。24 周试验，主要终点：HbA1c 降低。<br/><br/>发现：<br/>- A 组：平均 HbA1c 降低 1.8%<br/>- B 组：平均 HbA1c 降低 1.1%<br/>- A 组 68% vs. B 组 52% 达到 HbA1c \<7%<br/>- A 组：平均体重减轻 5.2kg<br/>- B 组：平均体重减轻 3.1kg<br/><br/>安全性：不良事件概况相似，无严重事件归因于治疗。<br/><br/>临床意义：双激动剂相比标准疗法显示出更优的血糖控制和体重减轻。可能是一个游戏改变者，特别是对于肥胖糖尿病患者。 |
    
    #### 提示 2
    | 角色 | 内容 |
    | ---- | ------- |
    | 用户 | 您的任务是对研究论文摘要提供反馈。以下是医学研究论文的摘要：<br/>\<summary><br/>\{\{SUMMARY\}\}<br/>\</summary><br/><br/>以下是研究论文：<br/>\<br/>\{\{RESEARCH_PAPER\}\}<br/>\</paper><br/><br/>按 A-F 等级审查此摘要的准确性、清晰度和完整性。 |
    | 助手<br/>\{\{FEEDBACK}} | 1. 准确性：A<br/>   - 正确报告了关键统计数据：HbA1c 降低、体重减轻。<br/>   - 准确注明了安全概况和无严重不良事件。<br/>   - "游戏改变者"的断言由显著更好的结果证实。<br/><br/>2. 清晰度：A-<br/>   - 简洁且结构良好，具有清晰的部分。<br/>   - 很好地使用了比较语言（例如，"从 Q1 上升 3%"）来提供背景。<br/>   - 小问题：缩写词如"RCT"、"GLP-1"和"GIP"未定义。考虑在首次使用时拼写出来。<br/><br/>3. 完整性：B+<br/>   - 涵盖所有请求的领域：方法、发现、临床意义。<br/>   - 缺失：组的基线特征（它们是否匹配良好？）。<br/>   - 缺失：任何次要终点（例如，血压、血脂）。<br/>   - 考虑：长期影响或进一步研究的必要性。<br/><br/>总体而言，摘要准确清晰，为快速掌握研究提供了关键见解。要提升到 A+，请定义缩写词、提及组基线统计数据、注明任何次要结果，并简要涉及长期研究的必要性。 |
    
     #### 提示 3
    | 角色 | 内容 |
    | ---- | ------- |
    | 用户 | 您的任务是根据反馈改进论文摘要。以下是医学研究论文的初稿：<br/>\<summary><br/>\{\{SUMMARY\}\}<br/>\</summary><br/><br/>以下是研究论文：<br/>\<br/>\{\{RESEARCH_PAPER\}\}<br/>\</paper><br/><br/>以下是反馈：<br/>\<feedback><br/>\{\{FEEDBACK\}\}<br/>\</feedback><br/><br/>根据反馈更新摘要。 |
    | 助手 | 方法：双盲随机对照试验 (RCT)，包含 500 名 2 型糖尿病患者。A 组 (n=250) 接受新型胰高血糖素样肽-1/葡萄糖依赖性促胰岛素多肽 (GLP-1/GIP) 双激动剂；B 组 (n=250) 接受标准 GLP-1 激动剂。24 周试验的主要终点是 HbA1c 降低。各组在年龄、BMI 和基线 HbA1c 方面匹配良好。<br/><br/>发现：<br/>- A 组：平均 HbA1c 降低 1.8%<br/>- B 组：平均 HbA1c 降低 1.1%<br/>- A 组 68% vs. B 组 52% 达到 HbA1c \<7%<br/>- A 组：平均体重减轻 5.2kg<br/>- B 组：平均体重减轻 3.1kg<br/><br/>次要终点显示两组血压和血脂概况都有改善，A 组结果略好。<br/><br/>安全性：不良事件概况相似，无严重事件归因于任一治疗。<br/><br/>临床意义：GLP-1/GIP 双激动剂相比标准 GLP-1 疗法显示出更优的血糖控制和体重减轻。这些结果表明它可能是一个重大进步，特别是对于肥胖糖尿病患者。然而，需要更长期的研究来确认持续的有效性和安全性，以及调查对心血管结果的潜在益处。 |
  
</section>

***

## 示例

  <section title="示例：分析法律合同（不链接）">

    请注意 Claude 遗漏了在其电子邮件草稿中提供建议更改的说明。

    | 角色 | 内容 |
    | ---- | ------- |
    | 用户 | 您是我们的首席法律官。审查此 SaaS 合同的风险，重点关注数据隐私、SLA 和责任上限。<br/><br/>\<contract><br/>\{\{CONTRACT}}<br/>\</contract><br/><br/>然后起草一封电子邮件给供应商，说明您的关切和建议的更改。 |
    | 助手 | 审查 SaaS 合同后，我发现了几个关切：<br/><br/>1. 数据隐私（第 7 条）：<br/>   - 问题：供应商有广泛的权利使用客户数据进行"服务改进"。<br/>   - 风险：可能导致未经授权的数据共享或货币化。<br/><br/>2. SLA（第 5 条）：<br/>   - 问题：99.5% 的正常运行时间保证低于行业标准。<br/>   - 风险：过度停机可能影响我们的运营。<br/><br/>3. 责任（第 9 条）：<br/>   - 问题：上限设置为 3 个月的费用。<br/>   - 风险：对于潜在的数据泄露或服务故障不足。<br/><br/>草稿电子邮件：<br/><br/>亲爱的 \{\{VENDOR}}，<br/><br/>审查 SaaS 协议后，我们有以下关切：<br/><br/>1. 数据隐私：我们要求我们的数据仅用于直接服务提供，而不是广泛的"服务改进"。请修改第 7 条。<br/><br/>2. SLA：99.5% 的正常运行时间不足。我们需要 99.99% 的正常运行时间，并明确定义的处罚。请修改第 5 条。<br/><br/>3. 责任：当前 3 个月费用的上限不足。我们建议将上限设置为 12 个月的费用，数据泄露或故意不当行为无上限。<br/><br/>我们重视我们的潜在合作伙伴关系，并相信这些更改将为我们的成功奠定基础。请发送修订后的协议。<br/><br/>此致<br/>敬礼<br/>\{\{CLO_NAME}} |
  
</section>

  <section title="示例：分析法律合同（链接）">

    #### 提示 1    
    | 角色 | 内容 |
    | ---- | ------- |
    | 用户 | 您是我们的首席法律官。审查此 SaaS 合同的风险，重点关注数据隐私、SLA 和责任上限。<br/><br/>\<contract><br/>\{\{CONTRACT}}<br/>\</contract><br/><br/>在 \<risks> 标签中输出您的发现。 |
    | 助手<br/>\{\{CONCERNS}} | 1. 数据隐私（第 7 条）：<br/>   - 问题：供应商有广泛的权利使用客户数据进行"服务改进"。<br/>   - 风险：可能导致未经授权的客户数据共享或货币化。<br/>   - 影响：潜在的客户信任破裂、监管罚款（GDPR、CCPA）。<br/><br/>2. SLA（第 5 条）：<br/>   - 问题：99.5% 的正常运行时间保证低于行业标准（通常为 99.99%）。<br/>   - 风险：每年最多 43.8 小时的停机时间 vs. 99.99% 时的 52.6 分钟。<br/>   - 影响：运营中断、收入损失、客户不满。<br/><br/>3. 责任（第 9 条）：<br/>   - 问题：责任上限设置为 3 个月的费用。<br/>   - 风险：对于潜在的数据泄露、IP 盗窃或长期服务故障不足。<br/>   - 影响：赔偿不足以弥补可能远超上限的损害，如集体诉讼或监管罚款。 |
    
    #### 提示 2    
    | 角色 | 内容 |
    | ---- | ------- |
    | 用户 | 起草一封电子邮件给 SaaS 产品供应商，概述以下关切并提议更改。以下是关切：<br/>\<concerns><br/>\{\{CONCERNS\}\}<br/>\</concerns><br/><br/>|
    | 助手<br/>\{\{EMAIL}} | 亲爱的 \{\{VENDOR}}，<br/><br/>经过对拟议 SaaS 协议的彻底审查，我们的法律团队确定了几个必须在我们继续之前解决的高优先级关切：<br/><br/>1. 数据隐私（第 7 条）：<br/>   - 当前：广泛的权利使用客户数据进行"服务改进"。<br/>   - 关切：潜在的未经授权的数据共享或货币化。<br/>   - 建议的更改：将数据使用限制为直接服务提供。任何用于改进、分析或营销的使用必须是选择加入、可撤销和匿名的。<br/><br/>2. SLA（第 5 条）：<br/>   - 当前：99.5% 的正常运行时间保证。<br/>   - 关切：每年最多 43.8 小时的停机时间，冒着运营中断的风险。<br/>   - 建议的更改：99.99% 的正常运行时间，分层服务信用。例如，\<99.99% 时 10% 信用，\<99.9% 时 25% 信用，\<99.5% 时 50% 信用。<br/><br/>3. 责任（第 9 条）：<br/>   - 当前：上限为 3 个月的费用。<br/>   - 关切：对于数据泄露、IP 盗窃或长期中断而言严重不足。<br/>   - 建议的更改：一般责任 12 个月的费用。数据泄露、故意不当行为、IP 侵权无上限。<br/><br/>这些更改对我们是非协商的。它们符合行业标准和我们对数据安全、运营卓越和受信责任的承诺。我们重视我们的合作伙伴关系潜力，解决这些问题将奠定坚实的基础。<br/><br/>请让您的法律团队审查并纳入这些更改。我们很乐意进一步讨论以确保相互理解和协议。<br/><br/>此致<br/>敬礼<br/>\{\{CLO_NAME}} |
    
    #### 提示 3    
    | 角色 | 内容 |
    | ---- | ------- |
    | 用户 | 您的任务是审查一封电子邮件并提供反馈。以下是电子邮件：<br/>\<email><br/>\{\{EMAIL\}\}<br/>\</email><br/><br/>对语气、清晰度和专业性提供反馈。 |
    | 助手 | 1. 语气：<br/>   - 专业和自信，但不对抗。<br/>   - 使用"非协商的"很强硬，但考虑到问题的关键性是合理的。<br/>   - 协作语言（"我们重视"、"很乐意讨论"）平衡了坚定性，保持了建设性的语气。<br/><br/>2. 清晰度：<br/>   - 优秀的结构：当前状态、关切和每个问题的建议更改。<br/>   - 技术术语（例如，"EBITDA"、"分层服务信用"）适合 B2B SaaS 背景。<br/>   - 行动项目清晰：供应商的法律团队审查并纳入更改。<br/><br/>3. 专业性：<br/>   - 关注相互利益和行业标准，而不仅仅是我们的要求。<br/>   - 提及更广泛的责任（数据安全、运营卓越、受信责任），提升讨论。<br/>   - 提供进一步讨论，显示对理解和解决问题的承诺。<br/><br/>总体而言，电子邮件在自信和协作之间取得了正确的平衡。它清楚地阐述了我们的关切，提出了具体的解决方案，并保持了专业的、以合作伙伴为导向的语气。无需修改；继续发送。 |
  
</section>
  <section title="示例：多租户策略审查">

    #### 提示 1    
    | 角色 | 内容 |
    | ---- | ------- |
    | 用户 | 作为高级解决方案架构师，审查和分析我们新企业 SaaS 产品的这个多租户策略。<br/><br/>\<strategy><br/>\{\{STRATEGY}}<br/>\</strategy><br/><br/>重点关注可扩展性、安全性和成本效益。 |
    | 助手<br/>\{\{ANALYSIS}} | 1. 可扩展性：<br/>   + 按租户的数据库分片减少争用，支持高增长。<br/>   + 微服务允许独立扩展组件。<br/>   - 共享应用服务器可能在极端负载下成为瓶颈。<br/>   - 没有提及应用层的自动扩展或负载平衡。<br/><br/>2. 安全性：<br/>   + 通过分片的租户数据隔离减轻数据泄露。<br/>   + 短期限和刷新令牌的 JWT 是行业最佳实践。<br/>   - 没有提及加密（静态、传输中）或密钥管理。<br/>   - IAM 策略缺乏关于角色、权限或 RBAC 的细节。<br/><br/>3. 成本效益：<br/>   + 共享应用服务器减少空闲资源成本。<br/>   + 用于不频繁任务的无服务器函数优化成本。<br/>   - 按租户的数据库在规模上可能增加成本 vs. 优化的多租户数据库。<br/>   - 没有讨论预留实例或现货实例以节省成本。 |
    
    #### 提示 2    
    | 角色 | 内容 |
    | ---- | ------- |
    | 用户 | 根据对多租户策略的分析，为工程领导层起草策略审查文档。<br/><br/>\<strategy><br/>\{\{STRATEGY}}<br/>\</strategy><br/><br/>\<analysis><br/>\{\{ANALYSIS}}<br/>\</analysis><br/><br/>包括执行摘要、详细分析和建议。 |
    | 助手<br/>\{\{STRATEGY_DOC}} | # 多租户策略审查：SaaS 企业产品<br/><br/>## 执行摘要<br/>拟议的策略在可扩展性和安全性原则方面展示了坚实的基础，但在实施细节方面存在差距。它在数据隔离和组件级扩展方面表现出色，但缺乏强大的应用层扩展和高级安全措施。成本优化是存在的，但在高规模时可能会失败。通过有针对性的增强，这个策略可以有效地支持我们的企业 SaaS 雄心。<br/><br/>## 详细分析<br/><br/>### 1. 可扩展性：B+<br/><br/>优势：<br/>- 按租户的数据库分片是优秀的。它最小化查询延迟，支持高数据增长，并促进无缝的按租户扩展。<br/>- 微服务架构允许根据需求扩展各个组件，对于处理多样化的企业工作负载至关重要。<br/><br/>劣势：<br/>- 共享应用服务器有成为瓶颈的风险。随着租户数量和流量的增长，这些可能会降低所有租户的性能。<br/>- 应用层缺少自动扩展和负载平衡是一个关键的疏忽。这些对于在不过度配置的情况下处理流量峰值至关重要。<br/><br/>### 2. 安全性：B-<br/><br/>优势：<br/>- 分片数据库提供强大的租户数据隔离，减轻租户之间数据泄露或未经授权访问的风险。<br/>- 短期限和刷新令牌的 JWT 符合 OWASP 最佳实践，减少令牌漏洞窗口。<br/><br/>劣势：<br/>- 没有提及静态或传输中的数据加密（TLS 1.3）。这对于企业数据是不可协商的。<br/>- 缺少密钥管理策略。如何管理和轮换加密密钥、JWT 秘密和数据库凭证？<br/>- IAM 缺乏深度。我们需要具有明确定义的角色的 RBAC、用于细粒度权限的基于属性的访问控制 (ABAC) 以及与企业身份提供商 (SAML、OIDC) 的集成。<br/><br/>### 3. 成本效益：B<br/><br/>优势：<br/>- 共享应用服务器减少空闲容量成本，对于稳定状态流量很好。<br/>- 用于不频繁任务（例如，报告）的无服务器是聪明的；仅在使用这些资源时付费。<br/><br/>劣势：<br/>- 按租户的数据库与设计良好的多租户数据库相比，在规模上可能不具成本效益，该数据库具有强大的数据分区。<br/>- 没有提及成本节省措施，如用于可预测工作负载的预留实例或用于容错任务的现货实例。<br/>- 缺少应用层自动扩展可能导致过度配置，增加成本。<br/><br/>## 建议<br/><br/>1. **应用层弹性**：使用 Kubernetes 或云原生服务（EKS、GKE）实施自动扩展。跨可用性区域部署，使用 CDN 处理静态资产。<br/><br/>2. **安全加固**：<br/>   a. 加密静态数据（AES-256）和传输中的数据（TLS 1.3）。<br/>   b. 使用托管 KMS（AWS KMS、GCP KMS）进行密钥管理。<br/>   c. 使用 RBAC、ABAC 和 SAML/OIDC 增强 IAM 以实现企业 SSO。<br/><br/>3. **成本优化**：<br/>   a. 在规模上评估列式多租户数据库（例如，Snowflake）vs. 分片。<br/>   b. 对应用服务器使用预留实例，对非关键工作负载使用现货实例。<br/>   c. 实施主动监控和适当调整大小以避免过度配置。<br/><br/>4. **概念验证 (PoC)**：在完整实施之前，使用高规模模拟进行 PoC：<br/>   a. 测试分片数据库 vs. 优化的多租户数据库的成本和性能。<br/>   b. 使用模拟的企业级流量峰值对应用层进行压力测试。<br/>   c. 进行第三方安全审计，重点关注数据隔离和访问控制。<br/><br/>通过这些增强，我们的多租户策略将是企业级的：可扩展、安全和成本效益。PoC 将验证我们的设计选择并为我们的企业客户灌输信心。 |
    
    #### 提示 3    
    | 角色 | 内容 |
    | ---- | ------- |
    | 用户 | 根据企业优先级为此策略审查文档评分，以获得清晰度、可操作性和对齐。<br/><br/>\<br/>\{\{PRIORITIES}}<br/>\</priorities><br/><br/>\<strategy_doc><br/>\{\{STRATEGY_DOC}}<br/>\</strategy_doc> |
    | 助手 | 1. 清晰度：A<br/>   + 清晰的结构，包括执行摘要、详细分析和建议。<br/>   + 分析使用评分系统（B+、B-）以快速掌握优势/劣势。<br/>   + 技术术语（RBAC、ABAC、TLS）被解释或背景化，帮助非技术领导。<br/>   + 视觉辅助（项目符号、缩进）增强可读性。<br/><br/>2. 可操作性：A-<br/>   + 建议是具体和技术性的（例如，"使用 Kubernetes 实施自动扩展"）。<br/>   + PoC 计划具有明确的目标，提供了路线图。<br/>   + 缺失：每个建议的时间表、资源要求或团队分配。<br/>   + 考虑：添加"后续步骤"部分，包括立即行动、角色和高级时间表。<br/><br/>3. 企业对齐：A+<br/>   + 直接解决企业优先级：<br/>     - 可扩展性：讨论处理企业级流量峰值。<br/>     - 安全性：关注数据隔离、加密和企业 IAM。<br/>     - 成本：策略符合企业 FinOps（预留实例、适当调整大小）。<br/>   + 使用"高规模模拟"和安全审计的 PoC 显示对企业级质量的承诺。<br/>   + 语言与企业关切相呼应："不可接受的风险"、"企业级"、"灌输信心"。<br/><br/>总体而言，该文档在清晰度和企业对齐方面表现出色。可操作性很强，但可以通过"后续步骤"部分提升到 A+。技术深度与清晰的解释相结合，使其对技术和非技术领导都非常有效。做得很好！ |
  
</section>

***

<CardGroup cols={3}>
  <Card title="提示库" icon="link" href="/docs/zh-CN/resources/prompt-library/library">
    获得为各种任务和用例精选的提示的灵感。
  </Card>
  <Card title="GitHub 提示教程" icon="link" href="https://github.com/anthropics/prompt-eng-interactive-tutorial">
    一个充满示例的教程，涵盖我们文档中的提示工程概念。
  </Card>
  <Card title="Google Sheets 提示教程" icon="link" href="https://docs.google.com/spreadsheets/d/19jzLgRruG9kjUQNKtCg1ZjdD6l6weA6qRXG5zLIAhC8">
    通过交互式电子表格的我们提示工程教程的轻量级版本。
  </Card>
</CardGroup>