# 速率限制

為了防止濫用並管理我們 API 的容量，我們對組織使用 Claude API 的方式實施了限制。

---

我們有兩種類型的限制：

1. **支出限制**設定組織在 API 使用上每月可能產生的最大成本。
2. **速率限制**設定組織在定義的時間段內可以進行的最大 API 請求數。

我們在組織級別強制執行服務配置的限制，但您也可以為組織的工作區設定使用者可配置的限制。

這些限制適用於標準和優先級層級的使用。有關優先級層級的更多資訊（提供增強的服務級別以換取承諾支出），請參閱[服務層級](/docs/zh-TW/api/service-tiers)。

## 關於我們的限制

* 限制旨在防止 API 濫用，同時最小化對常見客戶使用模式的影響。
* 限制由**使用層級**定義，其中每個層級與不同的支出和速率限制集相關聯。
* 當您在使用 API 時達到特定閾值時，您的組織將自動提升層級。
  限制在組織級別設定。您可以在 [Claude Console](/) 的[限制頁面](/settings/limits)中查看您組織的限制。
* 您可能在較短的時間間隔內達到速率限制。例如，每分鐘 60 個請求 (RPM) 的速率可能被強制執行為每秒 1 個請求。短時間內大量請求的突發可能會超過速率限制並導致速率限制錯誤。
* 下面列出的限制是我們的標準層級限制。如果您尋求更高的自訂限制或優先級層級以獲得增強的服務級別，請通過 [Claude Console](/settings/limits) 聯絡銷售。
* 我們使用[令牌桶演算法](https://en.wikipedia.org/wiki/Token_bucket)進行速率限制。這意味著您的容量會持續補充到您的最大限制，而不是在固定間隔重置。
* 此處描述的所有限制代表最大允許使用量，而非保證的最小值。這些限制旨在減少無意的超支並確保使用者之間的資源公平分配。

## 支出限制

每個使用層級都有一個限制，規定您每個日曆月在 API 上的支出。一旦您達到您層級的支出限制，在您符合下一個層級的資格之前，您必須等到下個月才能再次使用 API。

要符合下一個層級的資格，您必須滿足存款要求。為了最小化帳戶過度資金的風險，您不能存入超過您每月支出限制的金額。

### 晉級層級的要求
<table>
  <thead>
    <tr>
      <th>使用層級</th>
      <th>信用購買</th>
      <th>最大信用購買</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>層級 1</td>
      <td>\$5</td>
      <td>\$100</td>
    </tr>
    <tr>
      <td>層級 2</td>
      <td>\$40</td>
      <td>\$500</td>
    </tr>
    <tr>
      <td>層級 3</td>
      <td>\$200</td>
      <td>\$1,000</td>
    </tr>
    <tr>
      <td>層級 4</td>
      <td>\$400</td>
      <td>\$5,000</td>
    </tr>
    <tr>
      <td>月度發票</td>
      <td>N/A</td>
      <td>N/A</td>
    </tr>
  </tbody>
</table>

<Note>
**信用購買**顯示晉級到該層級所需的累積信用購買（不含稅）。您在達到閾值時立即晉級。

**最大信用購買**限制您在單筆交易中可以添加到帳戶的最大金額，以防止帳戶過度資金。
</Note>

## 速率限制

我們的 Messages API 速率限制以每分鐘請求數 (RPM)、每分鐘輸入令牌數 (ITPM) 和每分鐘輸出令牌數 (OTPM) 為單位測量，適用於每個模型類別。
如果您超過任何速率限制，您將收到一個[429 錯誤](/docs/zh-TW/api/errors)，描述超過了哪個速率限制，以及一個 `retry-after` 標頭，指示需要等待多長時間。

<Note>
如果您的組織在 API 上的使用量急劇增加，您可能還會遇到由於 API 加速限制而導致的 429 錯誤。為了避免達到加速限制，請逐漸增加您的流量並保持一致的使用模式。
</Note>

### 快取感知 ITPM

許多 API 提供商使用組合的「每分鐘令牌數」(TPM) 限制，可能包括所有令牌，包括快取和未快取、輸入和輸出。**對於大多數 Claude 模型，只有未快取的輸入令牌計入您的 ITPM 速率限制。** 這是一個關鍵優勢，使我們的速率限制實際上比初看起來要高。

ITPM 速率限制在每個請求開始時估計，並在請求期間調整以反映實際使用的輸入令牌數。

以下是計入 ITPM 的內容：
- `input_tokens`（最後一個快取斷點之後的令牌）✓ **計入 ITPM**
- `cache_creation_input_tokens`（被寫入快取的令牌）✓ **計入 ITPM**
- `cache_read_input_tokens`（從快取讀取的令牌）✗ **對於大多數模型，不計入 ITPM**

<Note>
`input_tokens` 欄位僅代表出現在**最後一個快取斷點之後**的令牌，而不是您請求中的所有輸入令牌。要計算總輸入令牌：

```
total_input_tokens = cache_read_input_tokens + cache_creation_input_tokens + input_tokens
```

這意味著當您有快取內容時，`input_tokens` 通常會遠小於您的總輸入。例如，使用 200K 令牌快取文檔和 50 令牌使用者問題，您會看到 `input_tokens: 50`，即使總輸入是 200,050 令牌。

出於大多數模型的速率限制目的，只有 `input_tokens` + `cache_creation_input_tokens` 計入您的 ITPM 限制，使[提示快取](/docs/zh-TW/build-with-claude/prompt-caching)成為增加有效吞吐量的有效方式。
</Note>

**範例**：使用 2,000,000 ITPM 限制和 80% 快取命中率，您每分鐘可以有效處理 10,000,000 個總輸入令牌（2M 未快取 + 8M 快取），因為快取令牌不計入您的速率限制。

<Note>
一些較舊的模型（在下面的速率限制表中用 † 標記）也將 `cache_read_input_tokens` 計入 ITPM 速率限制。

對於所有沒有 † 標記的模型，快取輸入令牌不計入速率限制，並以降低的速率計費（基本輸入令牌價格的 10%）。這意味著您可以通過使用[提示快取](/docs/zh-TW/build-with-claude/prompt-caching)來實現顯著更高的有效吞吐量。
</Note>

<Tip>
**使用提示快取最大化您的速率限制**

要充分利用您的速率限制，請對重複內容使用[提示快取](/docs/zh-TW/build-with-claude/prompt-caching)，例如：
- 系統指令和提示
- 大型上下文文檔
- 工具定義
- 對話歷史

通過有效的快取，您可以大幅增加實際吞吐量，而無需增加速率限制。在[使用頁面](/settings/usage)上監控您的快取命中率以優化您的快取策略。
</Tip>

OTPM 速率限制基於請求開始時的 `max_tokens` 進行估計，並在請求結束時調整以反映實際使用的輸出令牌數。
如果您比預期更早達到 OTPM 限制，請嘗試減少 `max_tokens` 以更好地近似您的完成大小。

速率限制分別應用於每個模型；因此您可以同時使用不同模型直到各自的限制。
您可以在 [Claude Console](/settings/limits) 中檢查您當前的速率限制和行為。

<Note>
對於長上下文請求（>200K 令牌），當使用帶有 Claude Sonnet 4.x 的 `context-1m-2025-08-07` 測試版標頭時，適用單獨的速率限制。請參閱下面的[長上下文速率限制](#long-context-rate-limits)。
</Note>

<Tabs>
<Tab title="層級 1">
| 模型                                                                                        | 最大每分鐘請求數 (RPM) | 最大每分鐘輸入令牌數 (ITPM) | 最大每分鐘輸出令牌數 (OTPM) |
| -------------------------------------------------------------------------------------------- | --------------------------------- | -------------------------------------- | --------------------------------------- |
| Claude Sonnet 4.x<sup>**</sup>                                                               | 50                                | 30,000                                 | 8,000                                   |
| Claude Sonnet 3.7 ([已棄用](/docs/zh-TW/about-claude/model-deprecations))                   | 50                                | 20,000                                 | 8,000                                   |
| Claude Haiku 4.5                                                                             | 50                                | 50,000                                 | 10,000                                  |
| Claude Haiku 3.5 ([已棄用](/docs/zh-TW/about-claude/model-deprecations))                    | 50                                | 50,000<sup>†</sup>                     | 10,000                                  |
| Claude Haiku 3                                                                               | 50                                | 50,000<sup>†</sup>                     | 10,000                                  |
| Claude Opus 4.x<sup>*</sup>                                                                  | 50                                | 30,000                                 | 8,000                                   |
| Claude Opus 3 ([已棄用](/docs/zh-TW/about-claude/model-deprecations))                      | 50                                | 20,000<sup>†</sup>                     | 4,000                                   |

</Tab>
<Tab title="層級 2">
| 模型                                                                                        | 最大每分鐘請求數 (RPM) | 最大每分鐘輸入令牌數 (ITPM) | 最大每分鐘輸出令牌數 (OTPM) |
| -------------------------------------------------------------------------------------------- | --------------------------------- | -------------------------------------- | --------------------------------------- |
| Claude Sonnet 4.x<sup>**</sup>                                                               | 1,000                             | 450,000                                | 90,000                                  |
| Claude Sonnet 3.7 ([已棄用](/docs/zh-TW/about-claude/model-deprecations))                   | 1,000                             | 40,000                                 | 16,000                                  |
| Claude Haiku 4.5                                                                             | 1,000                             | 450,000                                | 90,000                                  |
| Claude Haiku 3.5 ([已棄用](/docs/zh-TW/about-claude/model-deprecations))                    | 1,000                             | 100,000<sup>†</sup>                    | 20,000                                  |
| Claude Haiku 3                                                                               | 1,000                             | 100,000<sup>†</sup>                    | 20,000                                  |
| Claude Opus 4.x<sup>*</sup>                                                                  | 1,000                             | 450,000                                | 90,000                                  |
| Claude Opus 3 ([已棄用](/docs/zh-TW/about-claude/model-deprecations))                      | 1,000                             | 40,000<sup>†</sup>                     | 8,000                                   |

</Tab>
<Tab title="層級 3">
| 模型                                                                                        | 最大每分鐘請求數 (RPM) | 最大每分鐘輸入令牌數 (ITPM) | 最大每分鐘輸出令牌數 (OTPM) |
| -------------------------------------------------------------------------------------------- | --------------------------------- | -------------------------------------- | --------------------------------------- |
| Claude Sonnet 4.x<sup>**</sup>                                                               | 2,000                             | 800,000                                | 160,000                                 |
| Claude Sonnet 3.7 ([已棄用](/docs/zh-TW/about-claude/model-deprecations))                   | 2,000                             | 80,000                                 | 32,000                                  |
| Claude Haiku 4.5                                                                             | 2,000                             | 1,000,000                              | 200,000                                 |
| Claude Haiku 3.5 ([已棄用](/docs/zh-TW/about-claude/model-deprecations))                    | 2,000                             | 200,000<sup>†</sup>                    | 40,000                                  |
| Claude Haiku 3                                                                               | 2,000                             | 200,000<sup>†</sup>                    | 40,000                                  |
| Claude Opus 4.x<sup>*</sup>                                                                  | 2,000                             | 800,000                                | 160,000                                 |
| Claude Opus 3 ([已棄用](/docs/zh-TW/about-claude/model-deprecations))                      | 2,000                             | 80,000<sup>†</sup>                     | 16,000                                  |

</Tab>
<Tab title="層級 4">
| 模型                                                                                        | 最大每分鐘請求數 (RPM) | 最大每分鐘輸入令牌數 (ITPM) | 最大每分鐘輸出令牌數 (OTPM) |
| -------------------------------------------------------------------------------------------- | --------------------------------- | -------------------------------------- | --------------------------------------- |
| Claude Sonnet 4.x<sup>**</sup>                                                               | 4,000                             | 2,000,000                              | 400,000                                 |
| Claude Sonnet 3.7 ([已棄用](/docs/zh-TW/about-claude/model-deprecations))                   | 4,000                             | 200,000                                | 80,000                                  |
| Claude Haiku 4.5                                                                             | 4,000                             | 4,000,000                              | 800,000                                 |
| Claude Haiku 3.5 ([已棄用](/docs/zh-TW/about-claude/model-deprecations))                    | 4,000                             | 400,000<sup>†</sup>                    | 80,000                                  |
| Claude Haiku 3                                                                               | 4,000                             | 400,000<sup>†</sup>                    | 80,000                                  |
| Claude Opus 4.x<sup>*</sup>                                                                  | 4,000                             | 2,000,000                              | 400,000                                 |
| Claude Opus 3 ([已棄用](/docs/zh-TW/about-claude/model-deprecations))                      | 4,000                             | 400,000<sup>†</sup>                    | 80,000                                  |

</Tab>
<Tab title="自訂">
如果您尋求為企業使用案例提供更高的限制，請通過 [Claude Console](/settings/limits) 聯絡銷售。
</Tab>
</Tabs>

_<sup>* - Opus 4.x 速率限制是適用於 Opus 4、Opus 4.1 和 Opus 4.5 的組合流量的總限制。</sup>_

_<sup>** - Sonnet 4.x 速率限制是適用於 Sonnet 4 和 Sonnet 4.5 的組合流量的總限制。</sup>_

_<sup>† - 限制將 `cache_read_input_tokens` 計入 ITPM 使用量。</sup>_

### Message Batches API

Message Batches API 有自己的速率限制集，在所有模型中共享。這些包括對所有 API 端點的每分鐘請求數 (RPM) 限制，以及對可同時在處理隊列中的批次請求數的限制。這裡的「批次請求」是指 Message Batch 的一部分。您可以創建包含數千個批次請求的 Message Batch，每個都計入此限制。當批次請求尚未被模型成功處理時，它被視為處理隊列的一部分。

<Tabs>
<Tab title="層級 1">
| 最大每分鐘請求數 (RPM) | 處理隊列中的最大批次請求數 | 每個批次的最大批次請求數 |
| --------------------------------- | ------------------------------------------ | -------------------------------- |
| 50                                | 100,000                                    | 100,000                          |
</Tab>
<Tab title="層級 2">
| 最大每分鐘請求數 (RPM) | 處理隊列中的最大批次請求數 | 每個批次的最大批次請求數 |
| --------------------------------- | ------------------------------------------ | -------------------------------- |
| 1,000                             | 200,000                                    | 100,000                          |
</Tab>
<Tab title="層級 3">
| 最大每分鐘請求數 (RPM) | 處理隊列中的最大批次請求數 | 每個批次的最大批次請求數 |
| --------------------------------- | ------------------------------------------ | -------------------------------- |
| 2,000                             | 300,000                                    | 100,000                          |
</Tab>
<Tab title="層級 4">
| 最大每分鐘請求數 (RPM) | 處理隊列中的最大批次請求數 | 每個批次的最大批次請求數 |
| --------------------------------- | ------------------------------------------ | -------------------------------- |
| 4,000                             | 500,000                                    | 100,000                          |
</Tab>
<Tab title="自訂">
如果您尋求為企業使用案例提供更高的限制，請通過 [Claude Console](/settings/limits) 聯絡銷售。
</Tab>
</Tabs>

### 長上下文速率限制

當使用啟用了[1M 令牌上下文窗口](/docs/zh-TW/build-with-claude/context-windows#1m-token-context-window)的 Claude Sonnet 4 和 Sonnet 4.5 時，以下專用速率限制適用於超過 200K 令牌的請求。

<Note>
1M 令牌上下文窗口目前對使用層級 4 的組織和具有自訂速率限制的組織處於測試版。1M 令牌上下文窗口僅適用於 Claude Sonnet 4 和 Sonnet 4.5。
</Note>

<Tabs>
<Tab title="層級 4">
| 最大每分鐘輸入令牌數 (ITPM) | 最大每分鐘輸出令牌數 (OTPM) |
| -------------------------------------- | --------------------------------------- |
| 1,000,000                              | 200,000                                 |
</Tab>
<Tab title="自訂">
如需企業使用案例的自訂長上下文速率限制，請通過 [Claude Console](/settings/limits) 聯絡銷售。
</Tab>
</Tabs>

<Tip>
要充分利用 1M 令牌上下文窗口與速率限制，請使用[提示快取](/docs/zh-TW/build-with-claude/prompt-caching)。
</Tip>

### 在 Console 中監控您的速率限制

您可以在 [Claude Console](/) 的[使用](/settings/usage)頁面上監控您的速率限制使用情況。

除了提供令牌和請求圖表外，使用頁面還提供兩個單獨的速率限制圖表。使用這些圖表查看您有多少增長空間、您何時可能達到峰值使用、更好地了解要請求的速率限制，或如何改進您的快取速率。這些圖表為給定的速率限制（例如每個模型）可視化多個指標：

- **速率限制 - 輸入令牌**圖表包括：
  - 每分鐘未快取輸入令牌的每小時最大值
  - 您當前的每分鐘輸入令牌速率限制
  - 您的輸入令牌快取速率（即從快取讀取的輸入令牌百分比）
- **速率限制 - 輸出令牌**圖表包括：
  - 每分鐘輸出令牌的每小時最大值
  - 您當前的每分鐘輸出令牌速率限制

## 為工作區設定較低的限制

為了保護您組織中的工作區免受潛在過度使用，您可以為每個工作區設定自訂支出和速率限制。

範例：如果您的組織限制是每分鐘 40,000 個輸入令牌和 8,000 個輸出令牌，您可能會將一個工作區限制為每分鐘 30,000 個總令牌。這可以保護其他工作區免受潛在過度使用，並確保整個組織的資源更公平分配。然後，剩餘的未使用每分鐘令牌（或更多，如果該工作區不使用限制）可供其他工作區使用。

注意：
- 您無法在預設工作區上設定限制。
- 如果未設定，工作區限制與組織的限制相符。
- 組織範圍的限制始終適用，即使工作區限制加起來更多。
- 對工作區的輸入和輸出令牌限制的支持將在未來添加。

## 回應標頭

API 回應包括顯示強制執行的速率限制、當前使用情況以及何時重置限制的標頭。

返回以下標頭：

| 標頭                                        | 描述                                                                                                                                     |
| --------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------- |
| `retry-after`                                 | 在您可以重試請求之前需要等待的秒數。較早的重試將失敗。                                                                                                                      |
| `anthropic-ratelimit-requests-limit`          | 任何速率限制期間允許的最大請求數。                                                                                                                            |
| `anthropic-ratelimit-requests-remaining`      | 在被速率限制之前剩餘的請求數。                                                                                                                                     |
| `anthropic-ratelimit-requests-reset`          | 請求速率限制將完全補充的時間，以 RFC 3339 格式提供。                                                                                                                    |
| `anthropic-ratelimit-tokens-limit`            | 任何速率限制期間允許的最大令牌數。                                                                                                                              |
| `anthropic-ratelimit-tokens-remaining`        | 在被速率限制之前剩餘的令牌數（四捨五入到最近的千位）。                                                                                                                     |
| `anthropic-ratelimit-tokens-reset`            | 令牌速率限制將完全補充的時間，以 RFC 3339 格式提供。                                                                                                                      |
| `anthropic-ratelimit-input-tokens-limit`      | 任何速率限制期間允許的最大輸入令牌數。                                                                                                                        |
| `anthropic-ratelimit-input-tokens-remaining`  | 在被速率限制之前剩餘的輸入令牌數（四捨五入到最近的千位）。                                                                                                               |
| `anthropic-ratelimit-input-tokens-reset`      | 輸入令牌速率限制將完全補充的時間，以 RFC 3339 格式提供。                                                                                                                |
| `anthropic-ratelimit-output-tokens-limit`     | 任何速率限制期間允許的最大輸出令牌數。                                                                                                                       |
| `anthropic-ratelimit-output-tokens-remaining` | 在被速率限制之前剩餘的輸出令牌數（四捨五入到最近的千位）。                                                                                                              |
| `anthropic-ratelimit-output-tokens-reset`     | 輸出令牌速率限制將完全補充的時間，以 RFC 3339 格式提供。                                                                                                               |
| `anthropic-priority-input-tokens-limit`       | 任何速率限制期間允許的最大優先級層級輸入令牌數。（僅限優先級層級）                                                                                                     |
| `anthropic-priority-input-tokens-remaining`   | 在被速率限制之前剩餘的優先級層級輸入令牌數（四捨五入到最近的千位）。（僅限優先級層級）            |
| `anthropic-priority-input-tokens-reset`       | 優先級層級輸入令牌速率限制將完全補充的時間，以 RFC 3339 格式提供。（僅限優先級層級）             |
| `anthropic-priority-output-tokens-limit`      | 任何速率限制期間允許的最大優先級層級輸出令牌數。（僅限優先級層級）                                                                                                    |
| `anthropic-priority-output-tokens-remaining`  | 在被速率限制之前剩餘的優先級層級輸出令牌數（四捨五入到最近的千位）。（僅限優先級層級）           |
| `anthropic-priority-output-tokens-reset`      | 優先級層級輸出令牌速率限制將完全補充的時間，以 RFC 3339 格式提供。（僅限優先級層級）            |

`anthropic-ratelimit-tokens-*` 標頭顯示當前有效的最限制性限制的值。例如，如果您超過了工作區每分鐘令牌限制，標頭將包含工作區每分鐘令牌速率限制值。如果工作區限制不適用，標頭將返回總令牌剩餘量，其中總數是輸入和輸出令牌的總和。這種方法確保您可以看到對當前 API 使用的最相關限制。