# Claude に考えさせる（思考の連鎖プロンプティング）でパフォーマンスを向上させる

複雑なタスクに対して Claude に思考の時間を与えることで、パフォーマンスを大幅に向上させることができます。

---

<Note>
While these tips apply broadly to all Claude models, you can find prompting tips specific to extended thinking models [here](/docs/en/build-with-claude/prompt-engineering/extended-thinking-tips).
</Note>

研究、分析、問題解決などの複雑なタスクに直面した場合、Claude に考える余地を与えることで、パフォーマンスを大幅に向上させることができます。この手法は思考の連鎖（CoT）プロンプティングとして知られており、Claude が問題を段階的に分解し、より正確で微妙な出力につながります。

## CoT を実装する前に

### なぜ Claude に考えさせるのか？
- **正確性：** 問題を段階的に進めることで、特に数学、論理、分析、または一般的に複雑なタスクにおいてエラーを減らします。
- **一貫性：** 構造化された思考は、より結束力のある、よく整理された応答につながります。
- **デバッグ：** Claude の思考プロセスを見ることで、プロンプトが不明確な場所を特定するのに役立ちます。

### なぜ Claude に考えさせないのか？
- 出力の長さが増加し、レイテンシーに影響を与える可能性があります。
- すべてのタスクが深い思考を必要とするわけではありません。パフォーマンスとレイテンシーのバランスを確保するために、CoT を慎重に使用してください。

<Tip>複雑な数学、複数ステップの分析、複雑なドキュメントの作成、または多くの要因を伴う決定など、人間が考える必要があるタスクに CoT を使用してください。</Tip>

***

## 思考をプロンプトする方法

以下の思考の連鎖技法は、**最も単純なものから最も複雑なものの順に並べられています**。複雑さが低い方法はコンテキストウィンドウのスペースを少なく使用しますが、一般的にはそれほど強力ではありません。

<Tip>**CoT のヒント**：常に Claude に思考を出力させてください。思考プロセスを出力しなければ、思考は発生しません！</Tip>

- **基本的なプロンプト**：プロンプトに「段階的に考えてください」を含めます。
    - *どのように*考えるかについてのガイダンスが不足しています（特にタスクがアプリ、ユースケース、または組織に非常に固有の場合は理想的ではありません）
    <section title="例：ドナーメールの作成（基本的な CoT）">

        | ロール | コンテンツ |
        | ---- | ------- |
        | ユーザー | 今年の Care for Kids プログラムへの寄付をお願いするドナーへの個人化されたメールを作成してください。<br/><br/>プログラム情報：<br/>\\{\{PROGRAM_DETAILS}}<br/>\</program><br/><br/>ドナー情報：<br/>\<donor>\{\{DONOR_DETAILS}}<br/>\</donor><br/><br/>メールを書く前に段階的に考えてください。 |
    
</section>
- **ガイド付きプロンプト**：Claude が思考プロセスで従うべき特定のステップを概説します。
    - 答えから思考を簡単に取り出して分離するための構造化が不足しています。
    <section title="例：ドナーメールの作成（ガイド付き CoT）">

        | ロール | コンテンツ |
        | ---- | ------- |
        | ユーザー | 今年の Care for Kids プログラムへの寄付をお願いするドナーへの個人化されたメールを作成してください。<br/><br/>プログラム情報：<br/>\\{\{PROGRAM_DETAILS}}<br/>\</program><br/><br/>ドナー情報：<br/>\<donor>\{\{DONOR_DETAILS}}<br/>\</donor><br/><br/>メールを書く前に考えてください。まず、このドナーの寄付履歴と彼らがサポートしてきたキャンペーンを考慮して、このドナーにアピールする可能性のあるメッセージングについて考えてください。次に、彼らの履歴を考慮して、Care for Kids プログラムのどの側面が彼らにアピールするかについて考えてください。最後に、あなたの分析を使用して個人化されたドナーメールを書いてください。 |
    
</section>
- **構造化されたプロンプト**：`<thinking>` と `<answer>` のような XML タグを使用して、推論を最終的な答えから分離します。
     <section title="例：ドナーメールの作成（構造化されたガイド付き CoT）">

        | ロール | コンテンツ |
        | ---- | ------- |
        | ユーザー | 今年の Care for Kids プログラムへの寄付をお願いするドナーへの個人化されたメールを作成してください。<br/><br/>プログラム情報：<br/>\\{\{PROGRAM_DETAILS}}<br/>\</program><br/><br/>ドナー情報：<br/>\<donor>\{\{DONOR_DETAILS}}<br/>\</donor><br/><br/>\<thinking> タグ内でメールを書く前に考えてください。まず、このドナーの寄付履歴と彼らがサポートしてきたキャンペーンを考慮して、このドナーにアピールする可能性のあるメッセージングについて考えてください。次に、彼らの履歴を考慮して、Care for Kids プログラムのどの側面が彼らにアピールするかについて考えてください。最後に、あなたの分析を使用して \<email> タグ内に個人化されたドナーメールを書いてください。 |
    
</section>
    
### 例

  <section title="例：思考なしの財務分析">

    段階的な思考がなければ、Claude は妥当に見える推奨事項を提供しますが、深さが不足しています。潜在的な結果を定量化したり、情報に基づいた決定を下すために重要な過去の市場パフォーマンスを考慮していません。
    | ロール | コンテンツ |
    | ---- | ------- |
    | ユーザー | あなたは財務アドバイザーです。クライアントは \$10,000 を投資したいと考えています。彼らは 2 つのオプションから選択できます：A）歴史的には年間 12% のリターンを返しますが変動性が高い株式、または B）年間 6% を保証する債券。クライアントは 5 年以内に家の頭金のためにお金が必要です。どのオプションをお勧めしますか？ |
    | アシスタント | 提供された情報に基づいて、年間 6% のリターンを保証する債券であるオプション B をお勧めします。理由は以下の通りです：<br/><br/>1. 確実性：債券は年間 6% の保証されたリターンを提供し、財務計画に確実性をもたらします。これは、クライアントが特定の財務目標（頭金）と固定されたタイムライン（5 年）を持っている場合に重要です。<br/>2. リスク回避：クライアントが重要なライフイベント（家の購入）のためにこのお金が必要なため、彼らはおそらくリスク許容度が低いです。株式市場の変動性は、彼らがお金が必要な時期に近い景気後退がある場合、彼らの計画を危険にさらす可能性があります。<br/>3. 投資期間：わずか 5 年で、潜在的な株式市場の景気後退から回復する時間が少なくなります。より長い投資期間（10 年以上）は、一般的に株式市場の変動性に耐えるのに適しています。<br/><br/>株式の歴史的な 12% のリターンは魅力的ですが、過去のパフォーマンスは将来の結果を保証しません。債券からの保証された 6% は、クライアントが頭金を作成する時期に必要な資金を確保します。 |
  
</section>
  <section title="例：思考を伴う財務分析">

    段階的な思考により、アドバイザーはより豊かな分析を提供します。両方のシナリオの正確な数字を計算し、過去の市場変動性を考慮し、クライアントのリスク許容度を深く分析します。この徹底的な推論は、より自信を持った正当化可能な推奨事項につながります。
    | ロール | コンテンツ |
    | ---- | ------- |
    | ユーザー | あなたは財務アドバイザーです。クライアントは \$10,000 を投資したいと考えています。彼らは 2 つのオプションから選択できます：A）歴史的には年間 12% のリターンを返しますが変動性が高い株式、または B）年間 6% を保証する債券。クライアントは 5 年以内に家の頭金のためにお金が必要です。どのオプションをお勧めしますか？段階的に考えてください。 |
    | アシスタント | クライアントに最適な投資オプションを決定するために、複数の要因を段階的に考慮します：<br/><br/>\<thinking><br/>1. クライアントの目標とタイムラインを理解する：<br/>   - 目標：家の頭金<br/>   - タイムライン：5 年<br/>   - 意味：これは短期的で優先度の高い財務目標です。クライアントはおそらく大きなリスクまたは変動性を負担できません。<br/><br/>2. オプション A（株式）を分析する：<br/>   - 利点：より高い歴史的リターン（年間 12%）<br/>   - 欠点：変動性が高い（大幅な利益または損失の可能性を示唆）<br/>   - 5 年間のリターンの可能性を計算する：<br/>     - 最良のシナリオ（年間 12%）：\$10,000 * (1.12)^5 ≈ \$17,623.42<br/>     - 最悪のシナリオ（市場崩壊）：かなりの部分を失う可能性があります。例えば、50% の崩壊 = \$5,000<br/><br/>3. オプション B（債券）を分析する：<br/>   - 利点：保証されたリターン（年間 6%）<br/>   - 欠点：歴史的な株式パフォーマンスと比較して低いリターン<br/>   - 5 年間のリターンを計算する：<br/>     - 保証：\$10,000 * (1.06)^5 ≈ \$13,382.25<br/><br/>4. リスク許容度を考慮する：<br/>   - 目標は家の頭金（裁量的ではなく必須）<br/>   - 短いタイムライン（5 年）は市場の景気後退から回復する能力を制限します<br/>   - 結論：クライアントはおそらくリスク許容度が低い<br/><br/>5. 歴史的視点：<br/>   - 株式の 12% は歴史的であり、保証されていません<br/>   - 5 年間の期間では、株式市場は大きく変動する可能性があります：<br/>     - 2003-2007（金融危機前）：S&P 500 は約 82% 上昇<br/>     - 2007-2011（危機中）：S&P 500 は約 2% 下降<br/>   - 結論：過去のパフォーマンスは、特に短期的には将来の結果を保証しません<br/><br/>6. 最終分析：<br/>   - オプション A（株式）：より高い潜在的リターンですが、頭金目標を達成しないという許容できないリスク<br/>   - オプション B（債券）：最良のシナリオの株式の約 80% を達成することが保証され、資金を持つことが 100% 確実<br/>\</thinking><br/><br/>\<answer><br/>年間 6% の保証されたリターンを提供する債券であるオプション B をお勧めします。株式の歴史的な 12% のリターンは魅力的ですが、債券は 5 年で家の頭金のために \$13,382.25 を確保します。目標の重要性と短いタイムラインを考慮すると、株式の変動性は許容できないリスクをもたらします。債券は確実性を提供し、これはそのような重要な財務マイルストーンにとって非常に貴重です。<br/>\</answer> |
  
</section>

***

<CardGroup cols={3}>
  <Card title="プロンプトライブラリ" icon="link" href="/docs/ja/resources/prompt-library/library">
    様々なタスクとユースケースのための厳選されたプロンプトの選択からインスピレーションを得てください。
  </Card>
  <Card title="GitHub プロンプティングチュートリアル" icon="link" href="https://github.com/anthropics/prompt-eng-interactive-tutorial">
    ドキュメントに記載されているプロンプトエンジニアリングの概念をカバーする例が豊富なチュートリアル。
  </Card>
  <Card title="Google Sheets プロンプティングチュートリアル" icon="link" href="https://docs.google.com/spreadsheets/d/19jzLgRruG9kjUQNKtCg1ZjdD6l6weA6qRXG5zLIAhC8">
    インタラクティブなスプレッドシートを通じたプロンプトエンジニアリングチュートリアルのより軽量なバージョン。
  </Card>
</CardGroup>