# Предварительное заполнение ответа Claude для большего контроля над выводом

Узнайте, как предварительно заполнить ответ Claude, чтобы направить его действия, пропустить преамбулы и обеспечить определённые форматы вывода.

---

<Note>
While these tips apply broadly to all Claude models, you can find prompting tips specific to extended thinking models [here](/docs/en/build-with-claude/prompt-engineering/extended-thinking-tips).
</Note>

<Note>
Предварительное заполнение доступно только для режимов без расширенного мышления. В настоящее время оно не поддерживается с расширенным мышлением.
</Note>

При использовании Claude у вас есть уникальная возможность направлять его ответы, предварительно заполняя сообщение `Assistant`. Эта мощная техника позволяет вам направлять действия Claude, пропускать преамбулы, обеспечивать определённые форматы, такие как JSON или XML, и даже помогать Claude сохранять согласованность персонажа в сценариях ролевых игр.

В некоторых случаях, когда Claude работает не так, как ожидается, несколько предварительно заполненных предложений могут значительно улучшить производительность Claude. Небольшое предварительное заполнение имеет большое значение!

## Как предварительно заполнить ответ Claude

Чтобы предварительно заполнить, включите желаемый начальный текст в сообщение `Assistant` (ответ Claude будет продолжаться с того места, где заканчивается сообщение `Assistant`):

```python
import anthropic

client = anthropic.Anthropic()
response = client.messages.create(
    model="claude-sonnet-4-5",
    max_tokens=1024,
    messages=[
        {"role": "user", "content": "What is your favorite color?"},
        {"role": "assistant", "content": "As an AI assistant, I don't have a favorite color, But if I had to pick, it would be green because"}  # Prefill here
    ]
)
```

<Warning>
  Содержимое предварительного заполнения не может заканчиваться пробелом. Предварительное заполнение вроде `"As an AI assistant, I "` (с пробелом в конце) приведёт к ошибке.
</Warning>

### Примеры

#### Пример 1: Контроль форматирования вывода и пропуск преамбулы

<Tip>**Совет для опытных пользователей**: Предварительное заполнение `{` заставляет Claude пропустить преамбулу и напрямую вывести объект JSON. Это чище, более лаконично и проще для программ парсить без дополнительной обработки.
Для гарантированного вывода JSON, соответствующего определённой схеме, рассмотрите использование [Структурированных выводов](/docs/ru/build-with-claude/structured-outputs) вместо предварительного заполнения. Структурированные выводы гарантируют, что ответ Claude всегда соответствует вашей определённой схеме JSON, что идеально подходит для производственных приложений, требующих строгого соответствия формату.</Tip>

    <section title="Пример: Извлечение структурированных данных без предварительного заполнения">

    | Роль | Содержимое |
    | ---- | ------- |
    | User | Извлеките имя, размер, цену и цвет из этого описания продукта в виде объекта JSON:<br/><br/>\<description><br/>SmartHome Mini — это компактный помощник для умного дома, доступный в чёрном или белом цвете всего за \$49.99. Шириной всего 5 дюймов, он позволяет вам управлять освещением, термостатами и другими подключёнными устройствами голосом или приложением — независимо от того, где вы его разместите в своём доме. Этот доступный по цене небольшой концентратор обеспечивает удобное управление без рук для ваших умных устройств.<br/>\</description> |
    | Assistant | Вот извлечённая информация в формате JSON:<br/><br/>\`\`\`json<br/>\{<br/>  "name": "SmartHome Mini",<br/>  "size": "5 inches wide",<br/>  "price": "\$49.99",<br/>  "colors": ["black", "white"]<br/>\}<br/>\`\`\`<br/><br/>Я извлёк следующие детали из описания продукта:<br/>- **Имя**: SmartHome Mini<br/>- **Размер**: 5 дюймов в ширину<br/>- **Цена**: \$49.99<br/>- **Цвета**: Доступен в чёрном и белом цветах<br/><br/>Объект JSON предоставляет структурированный формат, который легко парсить и использовать программам. Дайте мне знать, если вам нужны какие-либо изменения или у вас есть другие вопросы! |
    
</section>

    <section title="Пример: Извлечение структурированных данных с предварительным заполнением">

    | Роль | Содержимое |
    | ---- | ------- |
    | User | Извлеките имя, размер, цену и цвет из этого описания продукта в виде объекта JSON:<br/><br/>\<description><br/>SmartHome Mini — это компактный помощник для умного дома, доступный в чёрном или белом цвете всего за \$49.99. Шириной всего 5 дюймов, он позволяет вам управлять освещением, термостатами и другими подключёнными устройствами голосом или приложением — независимо от того, где вы его разместите в своём доме. Этот доступный по цене небольшой концентратор обеспечивает удобное управление без рук для ваших умных устройств.<br/>\</description> |
    | Assistant (prefill) | \{ |
    | Assistant (Claude's response) | "name": "SmartHome Mini",<br/>"size": "5 inches wide",<br/>"price": "\$49.99",<br/>"colors": [<br/>  "black",<br/>  "white"<br/>]<br/>\} |
    
</section>

#### Пример 2: Сохранение персонажа в сценариях ролевых игр

<Tip>**Совет по ролевым играм**: Предварительное заполнение в скобках `[ROLE_NAME]` может напомнить Claude оставаться в образе, даже для более длительных и сложных разговоров. Это особенно мощно при сочетании с ролевым подсказыванием в параметре `system`.</Tip>

    <section title="Пример: Сохранение персонажа без ролевого подсказывания">

    | Роль | Содержимое |
    | ---- | ------- |
    | User (50 ходов разговора с Claude "Шерлок Холмс") | Что вы можете вывести о владельце этого ботинка? \<image>muddy_shoe.jpg\</image> |
    | Assistant | Как помощник ИИ, я был бы рад проанализировать изображение грязного ботинка, как если бы вы его предоставили. Вот мой вывод... |
    
</section>

    <section title="Пример: Сохранение персонажа с ролевым подсказыванием">

    | Роль | Содержимое |
    | ---- | ------- |
    | User (50 ходов разговора с Claude "Шерлок Холмс") | Что вы можете вывести о владельце этого ботинка? <br/>\<image>muddy_shoe.jpg\</image> |
    | Assistant (prefill) | [Sherlock Holmes] |
    | Assistant (Claude's response) | Ах, что у нас здесь? Самый любопытный экземпляр, Ватсон! Давайте рассмотрим этот ботинок проницательным взглядом. Грязь, видите ли, это не обычная лондонская глина, а скорее отличительный красноватый оттенок почвы, богатой железом, которая встречается только в окрестностях Хэмпстед-Хит. И всё же износ подошвы указывает на походку, более подходящую для булыжников Уайтчепела, чем для пологих склонов Хита.<br/><br/>Теперь обратите внимание на шнурки! Они завязаны особым узлом, который предпочитают люди медицинской профессии — несомненно, привычка, приобретённая за годы завязывания хирургических халатов. Но потёртости на носке рассказывают другую историю: они соответствуют движению удара, который можно использовать в боевых искусствах, в частности в Баритсу.<br/><br/>Мы можем заключить, что владелец этого ботинка — врач, возможно хирург, который проживает в Уайтчепеле, но часто посещает Хэмпстед-Хит — возможно, для тайной практики Баритсу, вдали от любопытных глаз. Самый интригующий случай, Ватсон! Мы должны поспешить; игра началась! |
    
</section>

---

<CardGroup cols={3}>
  <Card title="Работа с сообщениями" icon="messages" href="/docs/ru/build-with-claude/working-with-messages">
    Смотрите больше примеров предварительного заполнения и других паттернов Messages API.
  </Card>
  <Card title="Библиотека подсказок" icon="link" href="/docs/ru/resources/prompt-library/library">
    Вдохновитесь тщательно отобранной подборкой подсказок для различных задач и вариантов использования.
  </Card>
  <Card title="Учебник по подсказыванию GitHub" icon="link" href="https://github.com/anthropics/prompt-eng-interactive-tutorial">
    Полный учебник с примерами, охватывающий концепции инженерии подсказок, найденные в нашей документации.
  </Card>
  <Card title="Учебник по подсказыванию Google Sheets" icon="link" href="https://docs.google.com/spreadsheets/d/19jzLgRruG9kjUQNKtCg1ZjdD6l6weA6qRXG5zLIAhC8">
    Более лёгкая версия нашего учебника по инженерии подсказок через интерактивную электронную таблицу.
  </Card>
</CardGroup>